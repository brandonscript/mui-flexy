{"version":3,"file":"Flex.utils.js","sources":["../src/Flex.utils.ts"],"sourcesContent":["// @ts-ignore\nimport type { BoxProps, Grid2Props, GridProps } from \"@mui/material\";\nimport { CSSProperties } from \"react\";\n\nimport {\n  type InferFlexProps,\n  type ResponsiveFlexBoolean,\n  ResponsiveFlexDirection,\n  ResponsiveFlexPosition,\n} from \"./Flex.types\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype _Any = any;\n\nconst mapAlignment = (alignment?: _Any): ResponsiveFlexPosition => {\n  if (!alignment) return;\n  if (typeof alignment === \"string\") {\n    switch (alignment) {\n      case \"top\":\n      case \"left\":\n        return \"flex-start\";\n      case \"bottom\":\n      case \"right\":\n        return \"flex-end\";\n      default:\n        return alignment as ResponsiveFlexPosition;\n    }\n  }\n  if (Array.isArray(alignment)) {\n    return alignment.map(mapAlignment) as ResponsiveFlexPosition;\n  }\n  if (typeof alignment === \"object\") {\n    const mapped: _Any = {};\n    for (const [key, value] of Object.entries(alignment)) {\n      mapped[key] = mapAlignment(value);\n    }\n    return mapped as ResponsiveFlexPosition;\n  }\n  return alignment as ResponsiveFlexPosition;\n};\n\nconst mapDirection = (\n  direction: ResponsiveFlexDirection | undefined | null,\n  reverse: boolean | undefined | null = false,\n): ResponsiveFlexDirection => {\n  if (!direction) return \"row\";\n  if (typeof direction === \"string\") {\n    if (![\"row\", \"row-reverse\", \"column\", \"column-reverse\"].includes(direction)) {\n      console.warn(\n        `Using { flex-direction: ${direction} } with mui-flexy shorthand is not recommended \\\nbecause it can cause unexpected alignment and orientation anomalies.`,\n      );\n    }\n    switch (direction) {\n      case \"row\":\n      case \"column\":\n        return `${direction}${reverse ? \"-reverse\" : \"\"}`;\n      default:\n        return direction;\n    }\n  } else if (Array.isArray(direction)) {\n    return direction.map((d) => (!d ? \"row\" : mapDirection(d, reverse))) as ResponsiveFlexDirection;\n  } else if (typeof direction === \"object\") {\n    const mapped: _Any = {};\n    for (const [key, value] of Object.entries(direction)) {\n      mapped[key] = mapDirection(value, reverse);\n    }\n    return mapped as ResponsiveFlexDirection;\n  }\n};\n\nconst stringOrArrayValue = <V = unknown>(value: V, index: number) => {\n  if (typeof value === \"string\") {\n    return value;\n  } else if (Array.isArray(value)) {\n    return value?.[index];\n  }\n};\n\nconst mapResponsiveObject = (\n  direction: { [key: string]: CSSProperties[\"flexDirection\"] | null } | undefined | null,\n  main: ResponsiveFlexPosition,\n  cross: ResponsiveFlexPosition,\n) => {\n  return Object.fromEntries(\n    Object.entries(direction ?? []).map(([key, d]) => {\n      if (typeof d !== \"string\") {\n        throw new Error(\n          \"Values for a flex direction ResponsiveStyleObject must be strings, e.g. { xs: 'row', sm: 'column' }\",\n        );\n      }\n      if (d.startsWith(\"column\")) {\n        return [key, typeof cross === \"string\" ? cross : mapAlignment(cross)?.[key as keyof typeof cross]];\n      } else {\n        return [key, typeof main === \"string\" ? main : mapAlignment(main)?.[key as keyof typeof main]];\n      }\n    }),\n  );\n};\n\nconst resolveAlignment = (direction: ResponsiveFlexDirection, x: ResponsiveFlexPosition, y: ResponsiveFlexPosition) => {\n  if (typeof direction === \"string\") {\n    const isColumn = direction.startsWith(\"column\");\n    return {\n      justifyContent: mapAlignment(isColumn ? y : x),\n      alignItems: mapAlignment(isColumn ? x : y),\n    };\n  }\n\n  if (Array.isArray(direction)) {\n    return {\n      justifyContent: direction.map((d, i) => stringOrArrayValue(mapAlignment(d?.startsWith(\"column\") ? y : x), i)),\n      alignItems: direction.map((d, i) => stringOrArrayValue(mapAlignment(d?.startsWith(\"column\") ? x : y), i)),\n    };\n  }\n\n  if (typeof direction === \"object\") {\n    return {\n      justifyContent: mapResponsiveObject(direction, x, y),\n      alignItems: mapResponsiveObject(direction, y, x),\n    };\n  }\n\n  return { justifyContent: x, alignItems: y };\n};\n\ntype CSSFlexDirection = CSSProperties[\"flexDirection\"];\nconst resolveDirection = <R extends ResponsiveFlexDirection = ResponsiveFlexDirection>(\n  row: ResponsiveFlexDirection | ResponsiveFlexBoolean | undefined | null,\n  column: ResponsiveFlexDirection | ResponsiveFlexBoolean | undefined | null,\n  reverse: boolean | undefined | null = false,\n  fallback: ResponsiveFlexDirection = \"row\",\n): R | CSSFlexDirection | undefined => {\n  /* Maps boolean responsive row/column props to flexDirection values */\n\n  const rowIsNullOrUndefined = row === null || row === undefined;\n  const columnIsNullOrUndefined = column === null || column === undefined;\n\n  if (rowIsNullOrUndefined && columnIsNullOrUndefined) {\n    return mapDirection(fallback, reverse) as R;\n  }\n\n  const rowIsFalse = row === false;\n  const columnIsFalse = column === false;\n\n  let chooseRow = [true, \"row\"].includes(row as _Any) || columnIsFalse || columnIsNullOrUndefined;\n  let chooseColumn = [true, \"column\"].includes(column as _Any) || rowIsFalse || rowIsNullOrUndefined;\n\n  if (rowIsFalse && !columnIsFalse) {\n    chooseRow = false;\n    chooseColumn = true;\n  } else if (columnIsFalse && !rowIsFalse) {\n    chooseColumn = false;\n    chooseRow = true;\n  } else if (chooseRow && chooseColumn) {\n    chooseColumn = false;\n  }\n\n  const rowIsArray = Array.isArray(row);\n  const columnIsArray = Array.isArray(column);\n\n  const rowIsObject = typeof row === \"object\" && !rowIsArray && !rowIsNullOrUndefined;\n  const columnIsObject = typeof column === \"object\" && !columnIsArray && !columnIsNullOrUndefined;\n\n  if ([!rowIsObject, !columnIsObject, !rowIsArray, !columnIsArray].every(Boolean)) {\n    return mapDirection(chooseColumn ? \"column\" : chooseRow ? \"row\" : fallback, reverse) as R;\n  }\n\n  const rowIsFalsy = !row || (rowIsArray && !row.length) || (rowIsObject && !Object.keys(row).length);\n  const columnIsFalsy = !column || (columnIsArray && !column.length) || (columnIsObject && !Object.keys(column).length);\n\n  if (rowIsArray && columnIsFalsy) {\n    return row.map((r) => resolveDirection(r, column, reverse, fallback)) as R;\n  }\n\n  if (columnIsArray && rowIsFalsy) {\n    return column.map((c) => resolveDirection(row, c, reverse, fallback)) as R;\n  }\n\n  if (rowIsArray && columnIsArray) {\n    const composite: ResponsiveFlexDirection = [];\n    if (row.length !== column.length) {\n      console.warn(\n        `When using Array type ResponsiveFlexDirection for both 'row' and 'column', they should be the same length (have the same number of breakpoints) - got row=${JSON.stringify(\n          row,\n        )} and column=${JSON.stringify(column)}. You probably want to use just one or the other.`,\n      );\n\n      const longestLength = Math.max(row.length, column.length);\n\n      for (let i = 0; i < longestLength; i++) {\n        const r = row[i] ?? (column[i] === \"column\" ? \"row\" : \"column\");\n        const c = column[i] ?? (row[i] === \"row\" ? \"column\" : \"row\");\n        composite.push(resolveDirection(r, c, reverse, fallback) as CSSFlexDirection);\n      }\n      return composite as R;\n    }\n\n    // if any of the values in each array are both true for the same array index, warn in the console and default to 'row'\n    return row.map((r, i) => {\n      let c = column[i];\n      if (r && c) {\n        console.warn(\n          `When using Array type ResponsiveFlexDirection for both 'row' and 'column', they cannot not both be true for the same breakpoint index - got row=${JSON.stringify(\n            row,\n          )} and column=${JSON.stringify(column)}. Defaulting to 'row' for conflicting indices.`,\n        );\n        c = false;\n      }\n      return resolveDirection(r, c, reverse, fallback) as CSSFlexDirection;\n    }) as R;\n  }\n\n  if (rowIsObject && columnIsFalsy) {\n    return Object.fromEntries(\n      Object.entries(row)\n        .filter(([, r]) => ![null, undefined].includes(r))\n        .map(([k, r]) => [k, resolveDirection(r, undefined, reverse, fallback)]),\n    ) as R;\n  }\n\n  if (columnIsObject && rowIsFalsy) {\n    return Object.fromEntries(\n      Object.entries(column)\n        .filter(([, r]) => ![null, undefined].includes(r))\n        .map(([k, c]) => [k, resolveDirection(undefined, c, reverse, fallback)]),\n    ) as R;\n  }\n\n  if (rowIsObject && columnIsObject) {\n    const composite: { [key: string]: CSSFlexDirection } = {};\n    const keys = new Set([...Object.keys(row), ...Object.keys(column)]);\n\n    for (const key of keys) {\n      const r = row[key];\n      const c = column[key];\n      if ([null, undefined].includes(r as _Any) && [null, undefined].includes(c as _Any)) {\n        // if both are empty, omit the key\n        continue;\n      }\n      composite[key] = resolveDirection(r, c, reverse, fallback) as CSSFlexDirection;\n    }\n    return composite as R;\n  }\n};\n\ntype MappableFlexProps = Partial<InferFlexProps> & Partial<BoxProps | GridProps | Grid2Props>;\n\nexport const mapFlexProps = <P extends MappableFlexProps = MappableFlexProps>(\n  props: P,\n  ref?: React.Ref<_Any> | null,\n  componentName: \"Box\" | \"Grid\" | \"Grid2\" = \"Box\",\n) => {\n  const { x, y, row, column, flexDirection, reverse, nowrap, ...rest } = props;\n\n  const direction = resolveDirection(row, column, reverse, flexDirection as ResponsiveFlexDirection);\n\n  const whiteSpace = nowrap ? \"nowrap\" : props.whiteSpace;\n  const flexProps = { display: rest.display || \"flex\", whiteSpace };\n  const className = `${props.className || \"\"} MuiFlex-root${componentName ? ` MuiFlex${componentName}-root` : \"\"}`;\n\n  const alignments = resolveAlignment(direction, x, y);\n\n  return {\n    ...rest,\n    ...flexProps,\n    ...alignments,\n    flexDirection: direction,\n    className,\n    ref,\n  } as unknown as P;\n};\n\nexport const _test = {\n  mapAlignment,\n  mapDirection,\n  mapFlexProps,\n  resolveDirection,\n};\n"],"names":["mapAlignment","alignment","Array","isArray","map","_typeof","mapped","_i","_Object$entries","Object","entries","length","_Object$entries$_i","_slicedToArray","key","value","mapDirection","direction","reverse","arguments","undefined","includes","console","warn","concat","d","_i2","_Object$entries2","_Object$entries2$_i","stringOrArrayValue","index","mapResponsiveObject","main","cross","fromEntries","_ref","_ref2","Error","startsWith","_mapAlignment2","_mapAlignment3","resolveAlignment","x","y","isColumn","justifyContent","alignItems","i","resolveDirection","row","column","fallback","rowIsNullOrUndefined","columnIsNullOrUndefined","rowIsFalse","columnIsFalse","chooseRow","chooseColumn","rowIsArray","columnIsArray","rowIsObject","columnIsObject","every","Boolean","rowIsFalsy","keys","columnIsFalsy","r","c","composite","JSON","stringify","longestLength","Math","max","_row$i","_column$i","push","filter","_ref3","_ref4","_ref5","_ref6","k","_ref7","_ref8","_ref9","_ref0","Set","_toConsumableArray","_iterator","_createForOfIteratorHelper","_step","s","n","done","err","e","f","mapFlexProps","props","ref","componentName","flexDirection","nowrap","rest","_objectWithoutProperties","_excluded","whiteSpace","flexProps","display","className","alignments","_objectSpread"],"mappings":"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"}